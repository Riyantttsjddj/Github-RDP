- name: Install UltraVNC
  run: |
    Write-Output "üõ†Ô∏è Installing UltraVNC Server..."
    $installerPath = "$env:USERPROFILE\ultravnc.msi"
    
    # Coba download UltraVNC jika belum ada
    if (-not (Test-Path $installerPath)) {
        Write-Output "üîΩ Downloading UltraVNC Installer..."
        Invoke-WebRequest -Uri "https://uvnc.com/downloads/UltraVNC_1_3_81_Setup.exe" -OutFile $installerPath -UseBasicParsing
    }

    # Install UltraVNC secara silent
    Start-Process msiexec.exe -ArgumentList "/i $installerPath /quiet /norestart" -Wait
    Write-Output "‚úÖ UltraVNC Installed!"

- name: Verify UltraVNC Installation
  run: |
    Write-Output "üîé Verifying UltraVNC Installation..."
    $uvncPath1 = "C:\Program Files\uvnc bvba\UltraVNC\winvnc.exe"
    $uvncPath2 = "C:\Program Files (x86)\uvnc bvba\UltraVNC\winvnc.exe"

    if (Test-Path $uvncPath1) {
        Write-Output "‚úÖ UltraVNC found at $uvncPath1"
    } elseif (Test-Path $uvncPath2) {
        Write-Output "‚úÖ UltraVNC found at $uvncPath2"
    } else {
        Write-Output "‚ùå UltraVNC installation failed!"
        exit 1
    }

- name: Start UltraVNC Server
  run: |
    Write-Output "üöÄ Starting UltraVNC Server..."
    $uvncPath1 = "C:\Program Files\uvnc bvba\UltraVNC\winvnc.exe"
    $uvncPath2 = "C:\Program Files (x86)\uvnc bvba\UltraVNC\winvnc.exe"

    if (Test-Path $uvncPath1) {
        Start-Process -NoNewWindow -FilePath $uvncPath1
    } elseif (Test-Path $uvncPath2) {
        Start-Process -NoNewWindow -FilePath $uvncPath2
    } else {
        Write-Output "‚ùå UltraVNC executable not found!"
        exit 1
    }
    Write-Output "‚úÖ UltraVNC Server Started!"
    
